import{o as E}from"./index.es.3d20c51f.js";import{d as F,p as a,q as K,r,o as y,h as q,e as n,w as m,F as L,g as U,b as V,s as J}from"./vendor.1eacb0d1.js";const R=F({setup(M){const h={github:"https://api.github.com/search/repositories",gitee:"https://gitee.com/api/v5/search/repositories"},N=E(h).map(t=>({label:t,value:t})),f=10,S=(t,e)=>JSON.stringify([t,e]),d=a({});let c=a([]),s=a(1),g=a(0);const i=a("github");let v=a("vue"),p=a(!0),u=a(null);const x=()=>{p.value=!0,u.value=null;const t=S(i.value,{keyword:v.value,page:s.value});if(d.value[t]){c.value=d.value[t],p.value=!1;return}fetch(`${h[i.value]}?q=${v.value}&page=${s.value}&per_page=${f}`).then(e=>{var l;if(e.ok){const o=(l=e.headers.get("total_count"))!=null?l:"";Number.isNaN(Number.parseInt(o,10))||(g.value=Number.parseInt(o,10))}return e.json()}).then(e=>{var l,o;e.message&&e.documentation_url?(u.value=new Error(`${e.message} ${e.documentation_url}`),c.value=[]):(e.total_count&&(g.value=e.total_count),c.value=(l=e.items)!=null?l:e,d.value[t]=(o=e.items)!=null?o:e)}).catch(e=>{u.value=e,c.value=[]}).finally(()=>{p.value=!1})},j=t=>{v.value=t},$=()=>{s.value=1},z=t=>{s.value=t};return K([v,s,i],()=>{x()},{immediate:!0}),(t,e)=>{const l=r("a-select"),o=r("a-input-search"),w=r("a-col"),b=r("a-row"),I=r("a-result"),B=r("a-table");return y(),q(L,null,[n(b,{justify:"center"},{default:m(()=>[n(w,{span:24,lg:12},{default:m(()=>[n(o,{"default-value":v.value,"enter-button":"",onSearch:j},{addonBefore:m(()=>[n(l,{value:i.value,"onUpdate:value":e[0]||(e[0]=_=>i.value=_),options:U(N),onChange:$},null,8,["value","options"])]),_:1},8,["default-value"])]),_:1})]),_:1}),n(b,{justify:"center"},{default:m(()=>[n(w,{span:24,lg:12},{default:m(()=>{var _,C,k;return[!p.value&&u.value?(y(),V(I,{key:0,status:"error",title:(k=(C=(_=u.value)==null?void 0:_.message)!=null?C:u.value)!=null?k:"Unknown Error"},null,8,["title"])):J("",!0),n(B,{loading:p.value,class:"mt-4","data-source":c.value,"row-key":"id",size:"small",pagination:{current:s.value,pageSize:f,total:g.value,size:"small",position:["topCenter","bottomCenter"],showSizeChanger:!1,onChange:z},columns:[{title:"Name",dataIndex:"full_name",ellipsis:!0},{title:"Stars",dataIndex:"stargazers_count",width:80},{title:"Forks",dataIndex:"forks_count",width:80}]},null,8,["loading","data-source","pagination"])]}),_:1})]),_:1})],64)}}});export{R as default};
